node {
stage('SCM') {
git 'https://github.com/padeoe/TestJenkins.git/'
}
stage('QA') {
//????SonarQube????
sh 'sonar-scanner'
}
stage('build') {
//??maven??????
def mvnHome = tool 'M3'//??????????Maven????
sh "${mvnHome}/bin/mvn -B clean package"//Maven????????????
}
stage('deploy') {
//??Docker????????????`my`??????????
sh "docker stop my || true"//??????????????????
sh "docker rm my || true"//??????????????????
sh "docker run --name my -p 11111:8080 -d tomcat"//????????????????my??????
??????11111????????????????8080??????11111??????????8080??????????
sh "docker cp target/MavenDemo.war my:/usr/local/tomcat/webapps"//??????
??war??????????????tomcat/webapps??????
}
stage('results') {
//????????
archiveArtifacts artifacts: '**/target/*.war', fingerprint: true
}
}